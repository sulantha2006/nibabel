<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Neuroimaging in Python &#8212; NiBabel 2.1.1dev documentation</title>
    
    <link rel="stylesheet" href="../_static/nibabel.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.1.1dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="NiBabel 2.1.1dev documentation" href="../index.html" />
    <link rel="up" title="API Documentation" href="../api.html" />
    <link rel="next" title="arraywriters" href="nibabel.arraywriters.html" />
    <link rel="prev" title="spatialimages" href="nibabel.spatialimages.html" />
  <meta name="keywords" content="nipy, neuroimaging, python, neuroscience">

  </head>
  <body role="document">
<div style="background-color: white; text-align: left; padding-left: 150px; padding-bottom:50px; padding-top:20px; background-image: url(../_static/nipy-logo-bg-138x120.png); background-repeat: no-repeat;">
<h1>NiBabel</h1>
<h3 style="margin-top:-5px;color:#2f83c8">Access a cacophony of neuro-imaging file formats</h3>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="nibabel.arraywriters.html" title="arraywriters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nibabel.spatialimages.html" title="spatialimages"
             accesskey="P">previous</a> |</li>
  <li><a href="http://nipy.org/">Community</a> |&nbsp;</li>
  <li><a href="../index.html">NiBabel Home</a> |&nbsp;</li>
  <li><a href="https://mail.python.org/mailman/listinfo/neuroimaging">Mailing list</a> |&nbsp;</li>
  <li><a href="legal.html">License</a> |&nbsp;</li>

          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">API Documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><code class="docutils literal"><span class="pre">volumeutils</span></code></a><ul>
<li><a class="reference internal" href="#binopener"><code class="docutils literal"><span class="pre">BinOpener</span></code></a></li>
<li><a class="reference internal" href="#dtypemapper"><code class="docutils literal"><span class="pre">DtypeMapper</span></code></a></li>
<li><a class="reference internal" href="#recoder"><code class="docutils literal"><span class="pre">Recoder</span></code></a></li>
<li><a class="reference internal" href="#allopen">allopen</a></li>
<li><a class="reference internal" href="#apply-read-scaling">apply_read_scaling</a></li>
<li><a class="reference internal" href="#array-from-file">array_from_file</a></li>
<li><a class="reference internal" href="#array-to-file">array_to_file</a></li>
<li><a class="reference internal" href="#best-write-scale-ftype">best_write_scale_ftype</a></li>
<li><a class="reference internal" href="#better-float-of">better_float_of</a></li>
<li><a class="reference internal" href="#calculate-scale">calculate_scale</a></li>
<li><a class="reference internal" href="#can-cast">can_cast</a></li>
<li><a class="reference internal" href="#finite-range">finite_range</a></li>
<li><a class="reference internal" href="#fname-ext-ul-case">fname_ext_ul_case</a></li>
<li><a class="reference internal" href="#int-scinter-ftype">int_scinter_ftype</a></li>
<li><a class="reference internal" href="#make-dt-codes">make_dt_codes</a></li>
<li><a class="reference internal" href="#pretty-mapping">pretty_mapping</a></li>
<li><a class="reference internal" href="#rec2dict">rec2dict</a></li>
<li><a class="reference internal" href="#scale-min-max">scale_min_max</a></li>
<li><a class="reference internal" href="#seek-tell">seek_tell</a></li>
<li><a class="reference internal" href="#shape-zoom-affine">shape_zoom_affine</a></li>
<li><a class="reference internal" href="#working-type">working_type</a></li>
<li><a class="reference internal" href="#write-zeros">write_zeros</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nibabel.spatialimages.html"
                        title="previous chapter"><code class="docutils literal"><span class="pre">spatialimages</span></code></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nibabel.arraywriters.html"
                        title="next chapter"><code class="docutils literal"><span class="pre">arraywriters</span></code></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/reference/nibabel.volumeutils.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
<p><img src="../_static/reggie.png" alt="Reggie -- the one" /></p>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-nibabel.volumeutils">
<span id="volumeutils"></span><h1><code class="xref py py-mod docutils literal"><span class="pre">volumeutils</span></code><a class="headerlink" href="#module-nibabel.volumeutils" title="Permalink to this headline">¶</a></h1>
<p>Utility functions for analyze-like formats</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.BinOpener" title="nibabel.volumeutils.BinOpener"><code class="xref py py-obj docutils literal"><span class="pre">BinOpener</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Class to accept, maybe open, and context-manage file-likes / filenames</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.DtypeMapper" title="nibabel.volumeutils.DtypeMapper"><code class="xref py py-obj docutils literal"><span class="pre">DtypeMapper</span></code></a>()</td>
<td>Specialized mapper for numpy dtypes</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.Recoder" title="nibabel.volumeutils.Recoder"><code class="xref py py-obj docutils literal"><span class="pre">Recoder</span></code></a>(codes[,&nbsp;fields,&nbsp;map_maker])</td>
<td>class to return canonical code(s) from code or aliases</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.allopen" title="nibabel.volumeutils.allopen"><code class="xref py py-obj docutils literal"><span class="pre">allopen</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Compatibility wrapper for old <code class="docutils literal"><span class="pre">allopen</span></code> function</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.apply_read_scaling" title="nibabel.volumeutils.apply_read_scaling"><code class="xref py py-obj docutils literal"><span class="pre">apply_read_scaling</span></code></a>(arr[,&nbsp;slope,&nbsp;inter])</td>
<td>Apply scaling in <cite>slope</cite> and <cite>inter</cite> to array <cite>arr</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.array_from_file" title="nibabel.volumeutils.array_from_file"><code class="xref py py-obj docutils literal"><span class="pre">array_from_file</span></code></a>(shape,&nbsp;in_dtype,&nbsp;infile[,&nbsp;...])</td>
<td>Get array from file with specified shape, dtype and file offset</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.array_to_file" title="nibabel.volumeutils.array_to_file"><code class="xref py py-obj docutils literal"><span class="pre">array_to_file</span></code></a>(data,&nbsp;fileobj[,&nbsp;out_dtype,&nbsp;...])</td>
<td>Helper function for writing arrays to file objects</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.best_write_scale_ftype" title="nibabel.volumeutils.best_write_scale_ftype"><code class="xref py py-obj docutils literal"><span class="pre">best_write_scale_ftype</span></code></a>(arr[,&nbsp;slope,&nbsp;inter,&nbsp;...])</td>
<td>Smallest float type to contain range of <code class="docutils literal"><span class="pre">arr</span></code> after scaling</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.better_float_of" title="nibabel.volumeutils.better_float_of"><code class="xref py py-obj docutils literal"><span class="pre">better_float_of</span></code></a>(first,&nbsp;second[,&nbsp;default])</td>
<td>Return more capable float type of <cite>first</cite> and <cite>second</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.calculate_scale" title="nibabel.volumeutils.calculate_scale"><code class="xref py py-obj docutils literal"><span class="pre">calculate_scale</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Calculate scaling and optional intercept for data</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.can_cast" title="nibabel.volumeutils.can_cast"><code class="xref py py-obj docutils literal"><span class="pre">can_cast</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Return True if we can safely cast <code class="docutils literal"><span class="pre">in_type</span></code> to <code class="docutils literal"><span class="pre">out_type</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.finite_range" title="nibabel.volumeutils.finite_range"><code class="xref py py-obj docutils literal"><span class="pre">finite_range</span></code></a>(arr[,&nbsp;check_nan])</td>
<td>Get range (min, max) or range and flag (min, max, has_nan) from <cite>arr</cite></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.fname_ext_ul_case" title="nibabel.volumeutils.fname_ext_ul_case"><code class="xref py py-obj docutils literal"><span class="pre">fname_ext_ul_case</span></code></a>(fname)</td>
<td><cite>fname</cite> with ext changed to upper / lower case if file exists</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.int_scinter_ftype" title="nibabel.volumeutils.int_scinter_ftype"><code class="xref py py-obj docutils literal"><span class="pre">int_scinter_ftype</span></code></a>(ifmt[,&nbsp;slope,&nbsp;inter,&nbsp;default])</td>
<td>float type containing int type <cite>ifmt</cite> * <cite>slope</cite> + <cite>inter</cite></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.make_dt_codes" title="nibabel.volumeutils.make_dt_codes"><code class="xref py py-obj docutils literal"><span class="pre">make_dt_codes</span></code></a>(codes_seqs)</td>
<td>Create full dt codes Recoder instance from datatype codes</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.pretty_mapping" title="nibabel.volumeutils.pretty_mapping"><code class="xref py py-obj docutils literal"><span class="pre">pretty_mapping</span></code></a>(mapping[,&nbsp;getterfunc])</td>
<td>Make pretty string from mapping</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.rec2dict" title="nibabel.volumeutils.rec2dict"><code class="xref py py-obj docutils literal"><span class="pre">rec2dict</span></code></a>(rec)</td>
<td>Convert recarray to dictionary</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.scale_min_max" title="nibabel.volumeutils.scale_min_max"><code class="xref py py-obj docutils literal"><span class="pre">scale_min_max</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>Return scaling and intercept min, max of data, given output type</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.seek_tell" title="nibabel.volumeutils.seek_tell"><code class="xref py py-obj docutils literal"><span class="pre">seek_tell</span></code></a>(fileobj,&nbsp;offset[,&nbsp;write0])</td>
<td>Seek in <cite>fileobj</cite> or check we&#8217;re in the right place already</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.shape_zoom_affine" title="nibabel.volumeutils.shape_zoom_affine"><code class="xref py py-obj docutils literal"><span class="pre">shape_zoom_affine</span></code></a>(shape,&nbsp;zooms[,&nbsp;x_flip])</td>
<td>Get affine implied by given shape and zooms</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#nibabel.volumeutils.working_type" title="nibabel.volumeutils.working_type"><code class="xref py py-obj docutils literal"><span class="pre">working_type</span></code></a>(in_type[,&nbsp;slope,&nbsp;inter])</td>
<td>Return array type from applying <cite>slope</cite>, <cite>inter</cite> to array of <cite>in_type</cite></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#nibabel.volumeutils.write_zeros" title="nibabel.volumeutils.write_zeros"><code class="xref py py-obj docutils literal"><span class="pre">write_zeros</span></code></a>(fileobj,&nbsp;count[,&nbsp;block_size])</td>
<td>Write <cite>count</cite> zero bytes to <cite>fileobj</cite></td>
</tr>
</tbody>
</table>
<div class="section" id="binopener">
<h2><a class="reference internal" href="#nibabel.volumeutils.BinOpener" title="nibabel.volumeutils.BinOpener"><code class="xref py py-class docutils literal"><span class="pre">BinOpener</span></code></a><a class="headerlink" href="#binopener" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nibabel.volumeutils.BinOpener">
<em class="property">class </em><code class="descclassname">nibabel.volumeutils.</code><code class="descname">BinOpener</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.BinOpener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="nibabel.openers.html#nibabel.openers.Opener" title="nibabel.openers.Opener"><code class="xref py py-class docutils literal"><span class="pre">nibabel.openers.Opener</span></code></a></p>
<p>Class to accept, maybe open, and context-manage file-likes / filenames</p>
<p>Provides context manager to close files that the constructor opened for
you.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileish</strong> : str or file-like</p>
<blockquote>
<div><p>if str, then open with suitable opening method. If file-like, accept as
is</p>
</div></blockquote>
<p><strong>*args</strong> : positional arguments</p>
<blockquote>
<div><p>passed to opening method when <cite>fileish</cite> is str.  <code class="docutils literal"><span class="pre">mode</span></code>, if not
specified, is <cite>rb</cite>.  <code class="docutils literal"><span class="pre">compresslevel</span></code>, if relevant, and not specified,
is set from class variable <code class="docutils literal"><span class="pre">default_compresslevel</span></code></p>
</div></blockquote>
<p><strong>**kwargs</strong> : keyword arguments</p>
<blockquote class="last">
<div><p>passed to opening method when <cite>fileish</cite> is str.  Change of defaults as
for *args</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p>BinOpener class deprecated. Please use Opener class instead.2.1</p>
<ul class="simple">
<li>deprecated from version: 4.0</li>
</ul>
<dl class="method">
<dt id="nibabel.volumeutils.BinOpener.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.BinOpener.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>BinOpener class deprecated. Please use Opener class instead.2.1</p>
<ul class="simple">
<li>deprecated from version: 4.0</li>
</ul>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="dtypemapper">
<h2><a class="reference internal" href="#nibabel.volumeutils.DtypeMapper" title="nibabel.volumeutils.DtypeMapper"><code class="xref py py-class docutils literal"><span class="pre">DtypeMapper</span></code></a><a class="headerlink" href="#dtypemapper" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nibabel.volumeutils.DtypeMapper">
<em class="property">class </em><code class="descclassname">nibabel.volumeutils.</code><code class="descname">DtypeMapper</code><a class="headerlink" href="#nibabel.volumeutils.DtypeMapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Specialized mapper for numpy dtypes</p>
<p>We pass this mapper into the Recoder class to deal with numpy dtype
hashing.</p>
<p>The hashing problem is that dtypes that compare equal may not have the same
hash.  This is true for numpys up to the current at time of writing
(1.6.0).  For numpy 1.2.1 at least, even dtypes that look exactly the same
in terms of fields don&#8217;t always have the same hash.  This makes dtypes
difficult to use as keys in a dictionary.</p>
<p>This class wraps a dictionary in order to implement a __getitem__ to deal
with dtype hashing. If the key doesn&#8217;t appear to be in the mapping, and it
is a dtype, we compare (using ==) all known dtype keys to the input key,
and return any matching values for the matching key.</p>
<dl class="method">
<dt id="nibabel.volumeutils.DtypeMapper.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.DtypeMapper.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nibabel.volumeutils.DtypeMapper.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.DtypeMapper.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="nibabel.volumeutils.DtypeMapper.values">
<code class="descname">values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.DtypeMapper.values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="recoder">
<h2><a class="reference internal" href="#nibabel.volumeutils.Recoder" title="nibabel.volumeutils.Recoder"><code class="xref py py-class docutils literal"><span class="pre">Recoder</span></code></a><a class="headerlink" href="#recoder" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="nibabel.volumeutils.Recoder">
<em class="property">class </em><code class="descclassname">nibabel.volumeutils.</code><code class="descname">Recoder</code><span class="sig-paren">(</span><em>codes</em>, <em>fields=('code'</em>, <em>)</em>, <em>map_maker=&lt;type 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.Recoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>class to return canonical code(s) from code or aliases</p>
<p>The concept is a lot easier to read in the implementation and
tests than it is to explain, so...</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># If you have some codes, and several aliases, like this:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">aliases1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">code2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">aliases2</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># You might want to do this:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">codes</span> <span class="o">=</span> <span class="p">[[</span><span class="n">code1</span><span class="p">]</span><span class="o">+</span><span class="n">aliases1</span><span class="p">,[</span><span class="n">code2</span><span class="p">]</span><span class="o">+</span><span class="n">aliases2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span> <span class="o">=</span> <span class="n">Recoder</span><span class="p">(</span><span class="n">codes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="o">.</span><span class="n">code</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="o">.</span><span class="n">code</span><span class="p">[</span><span class="s1">&#39;second&#39;</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="o">.</span><span class="n">code</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or maybe you have a code, a label and some aliases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">codes</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;label1&#39;</span><span class="p">,</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;label2&#39;</span><span class="p">,</span><span class="s1">&#39;two&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># you might want to get back the code or the label</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span> <span class="o">=</span> <span class="n">Recoder</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="o">.</span><span class="n">code</span><span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="o">.</span><span class="n">code</span><span class="p">[</span><span class="s1">&#39;label1&#39;</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="o">.</span><span class="n">label</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&#39;label2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># For convenience, you can get the first entered name by</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># indexing the object directly</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">recodes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Create recoder object</p>
<p><code class="docutils literal"><span class="pre">codes</span></code> give a sequence of code, alias sequences
<code class="docutils literal"><span class="pre">fields</span></code> are names by which the entries in these sequences can be
accessed.</p>
<p>By default <code class="docutils literal"><span class="pre">fields</span></code> gives the first column the name
&#8220;code&#8221;.  The first column is the vector of first entries
in each of the sequences found in <code class="docutils literal"><span class="pre">codes</span></code>.  Thence you can
get the equivalent first column value with ob.code[value],
where value can be a first column value, or a value in any of
the other columns in that sequence.</p>
<p>You can give other columns names too, and access them in the
same way - see the examples in the class docstring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>codes</strong> : seqence of sequences</p>
<blockquote>
<div><p>Each sequence defines values (codes) that are equivalent</p>
</div></blockquote>
<p><strong>fields</strong> : {(&#8216;code&#8217;,) string sequence}, optional</p>
<blockquote>
<div><p>names by which elements in sequences can be accessed</p>
</div></blockquote>
<p><strong>map_maker: callable, optional</strong></p>
<blockquote class="last">
<div><p>constructor for dict-like objects used to store key value pairs.
Default is <code class="docutils literal"><span class="pre">dict</span></code>.  <code class="docutils literal"><span class="pre">map_maker()</span></code> generates an empty mapping.
The mapping need only implement <code class="docutils literal"><span class="pre">__getitem__,</span> <span class="pre">__setitem__,</span> <span class="pre">keys,</span>
<span class="pre">values</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nibabel.volumeutils.Recoder.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>codes</em>, <em>fields=('code'</em>, <em>)</em>, <em>map_maker=&lt;type 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.Recoder.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Create recoder object</p>
<p><code class="docutils literal"><span class="pre">codes</span></code> give a sequence of code, alias sequences
<code class="docutils literal"><span class="pre">fields</span></code> are names by which the entries in these sequences can be
accessed.</p>
<p>By default <code class="docutils literal"><span class="pre">fields</span></code> gives the first column the name
&#8220;code&#8221;.  The first column is the vector of first entries
in each of the sequences found in <code class="docutils literal"><span class="pre">codes</span></code>.  Thence you can
get the equivalent first column value with ob.code[value],
where value can be a first column value, or a value in any of
the other columns in that sequence.</p>
<p>You can give other columns names too, and access them in the
same way - see the examples in the class docstring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>codes</strong> : seqence of sequences</p>
<blockquote>
<div><p>Each sequence defines values (codes) that are equivalent</p>
</div></blockquote>
<p><strong>fields</strong> : {(&#8216;code&#8217;,) string sequence}, optional</p>
<blockquote>
<div><p>names by which elements in sequences can be accessed</p>
</div></blockquote>
<p><strong>map_maker: callable, optional</strong></p>
<blockquote class="last">
<div><p>constructor for dict-like objects used to store key value pairs.
Default is <code class="docutils literal"><span class="pre">dict</span></code>.  <code class="docutils literal"><span class="pre">map_maker()</span></code> generates an empty mapping.
The mapping need only implement <code class="docutils literal"><span class="pre">__getitem__,</span> <span class="pre">__setitem__,</span> <span class="pre">keys,</span>
<span class="pre">values</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nibabel.volumeutils.Recoder.add_codes">
<code class="descname">add_codes</code><span class="sig-paren">(</span><em>code_syn_seqs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.Recoder.add_codes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add codes to object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>code_syn_seqs</strong> : sequence</p>
<blockquote class="last">
<div><p>sequence of sequences, where each sequence <code class="docutils literal"><span class="pre">S</span> <span class="pre">=</span> <span class="pre">code_syn_seqs[n]</span></code>
for n in 0..len(code_syn_seqs), is a sequence giving values in the
same order as <code class="docutils literal"><span class="pre">self.fields</span></code>.  Each S should be at least of the
same length as <code class="docutils literal"><span class="pre">self.fields</span></code>.  After this call, if <code class="docutils literal"><span class="pre">self.fields</span>
<span class="pre">==</span> <span class="pre">['field1',</span> <span class="pre">'field2'],</span> <span class="pre">then</span> <span class="pre">``self.field1[S[n]]</span> <span class="pre">==</span> <span class="pre">S[0]</span></code> for all
n in 0..len(S) and <code class="docutils literal"><span class="pre">self.field2[S[n]]</span> <span class="pre">==</span> <span class="pre">S[1]</span></code> for all n in
0..len(S).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">code_syn_seqs</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span> <span class="o">=</span> <span class="n">Recoder</span><span class="p">(</span><span class="n">code_syn_seqs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span><span class="o">.</span><span class="n">value_set</span><span class="p">()</span> <span class="o">==</span> <span class="nb">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span><span class="o">.</span><span class="n">add_codes</span><span class="p">(((</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;first&#39;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rc</span><span class="o">.</span><span class="n">value_set</span><span class="p">()</span> <span class="o">==</span> <span class="nb">set</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="nibabel.volumeutils.Recoder.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.Recoder.keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all available code and alias values</p>
<p>Returns same value as <code class="docutils literal"><span class="pre">obj.field1.keys()</span></code> and, with the
default initializing <code class="docutils literal"><span class="pre">fields</span></code> argument of fields=(&#8216;code&#8217;,),
this will return the same as <code class="docutils literal"><span class="pre">obj.code.keys()</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">codes</span> <span class="o">=</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;repeat value&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">Recoder</span><span class="p">(</span><span class="n">codes</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">set</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;repeat value&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="nibabel.volumeutils.Recoder.value_set">
<code class="descname">value_set</code><span class="sig-paren">(</span><em>name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.Recoder.value_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return set of possible returned values for column</p>
<p>By default, the column is the first column.</p>
<p>Returns same values as <code class="docutils literal"><span class="pre">set(obj.field1.values())</span></code> and,
with the default initializing``fields`` argument of
fields=(&#8216;code&#8217;,), this will return the same as
<code class="docutils literal"><span class="pre">set(obj.code.values())</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : {None, string}</p>
<blockquote>
<div><p>Where default of none gives result for first column</p>
</div></blockquote>
<p><strong>&gt;&gt;&gt; codes = ((1, &#8216;one&#8217;), (2, &#8216;two&#8217;), (1, &#8216;repeat value&#8217;))</strong></p>
<p><strong>&gt;&gt;&gt; vs = Recoder(codes).value_set()</strong></p>
<p><strong>&gt;&gt;&gt; vs == set([1, 2]) # Sets are not ordered, hence this test</strong></p>
<p><strong>True</strong></p>
<p><strong>&gt;&gt;&gt; rc = Recoder(codes, fields=(&#8216;code&#8217;, &#8216;label&#8217;))</strong></p>
<p><strong>&gt;&gt;&gt; rc.value_set(&#8216;label&#8217;) == set((&#8216;one&#8217;, &#8216;two&#8217;, &#8216;repeat value&#8217;))</strong></p>
<p class="last"><strong>True</strong></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="allopen">
<h2>allopen<a class="headerlink" href="#allopen" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.allopen">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">allopen</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.allopen" title="Permalink to this definition">¶</a></dt>
<dd><p>Compatibility wrapper for old <code class="docutils literal"><span class="pre">allopen</span></code> function</p>
<p>allopen is deprecated. Please use &#8220;Opener&#8221; class instead.</p>
<ul class="simple">
<li>deprecated from version: 2.0</li>
<li>Will raise &lt;class &#8216;nibabel.deprecator.ExpiredDeprecationError&#8217;&gt; as of version: 4.0</li>
</ul>
<p>Wraps creation of <code class="docutils literal"><span class="pre">Opener</span></code> instance, while picking up module global
<code class="docutils literal"><span class="pre">default_compresslevel</span></code>.</p>
<p>Please see docstring of <code class="docutils literal"><span class="pre">Opener</span></code> for details.</p>
</dd></dl>

</div>
<div class="section" id="apply-read-scaling">
<h2>apply_read_scaling<a class="headerlink" href="#apply-read-scaling" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.apply_read_scaling">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">apply_read_scaling</code><span class="sig-paren">(</span><em>arr</em>, <em>slope=None</em>, <em>inter=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.apply_read_scaling" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply scaling in <cite>slope</cite> and <cite>inter</cite> to array <cite>arr</cite></p>
<p>This is for loading the array from a file (as opposed to the reverse
scaling when saving an array to file)</p>
<p>Return data will be <code class="docutils literal"><span class="pre">arr</span> <span class="pre">*</span> <span class="pre">slope</span> <span class="pre">+</span> <span class="pre">inter</span></code>. The trick is that we have to
find a good precision to use for applying the scaling.  The heuristic is
that the data is always upcast to the higher of the types from <cite>arr,
`slope</cite>, <cite>inter</cite> if <cite>slope</cite> and / or <cite>inter</cite> are not default values. If the
dtype of <cite>arr</cite> is an integer, then we assume the data more or less fills
the integer range, and upcast to a type such that the min, max of
<code class="docutils literal"><span class="pre">arr.dtype</span></code> * scale + inter, will be finite.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>arr</strong> : array-like</p>
<p><strong>slope</strong> : None or float, optional</p>
<blockquote>
<div><p>slope value to apply to <cite>arr</cite> (<code class="docutils literal"><span class="pre">arr</span> <span class="pre">*</span> <span class="pre">slope</span> <span class="pre">+</span> <span class="pre">inter</span></code>).  None
corresponds to a value of 1.0</p>
</div></blockquote>
<p><strong>inter</strong> : None or float, optional</p>
<blockquote>
<div><p>intercept value to apply to <cite>arr</cite> (<code class="docutils literal"><span class="pre">arr</span> <span class="pre">*</span> <span class="pre">slope</span> <span class="pre">+</span> <span class="pre">inter</span></code>).  None
corresponds to a value of 0.0</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ret</strong> : array</p>
<blockquote class="last">
<div><p>array with scaling applied.  Maybe upcast in order to give room for the
scaling. If scaling is default (1, 0), then <cite>ret</cite> may be <cite>arr</cite> <code class="docutils literal"><span class="pre">ret</span> <span class="pre">is</span>
<span class="pre">arr</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="array-from-file">
<h2>array_from_file<a class="headerlink" href="#array-from-file" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.array_from_file">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">array_from_file</code><span class="sig-paren">(</span><em>shape</em>, <em>in_dtype</em>, <em>infile</em>, <em>offset=0</em>, <em>order='F'</em>, <em>mmap=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.array_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Get array from file with specified shape, dtype and file offset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>shape</strong> : sequence</p>
<blockquote>
<div><p>sequence specifying output array shape</p>
</div></blockquote>
<p><strong>in_dtype</strong> : numpy dtype</p>
<blockquote>
<div><p>fully specified numpy dtype, including correct endianness</p>
</div></blockquote>
<p><strong>infile</strong> : file-like</p>
<blockquote>
<div><p>open file-like object implementing at least read() and seek()</p>
</div></blockquote>
<p><strong>offset</strong> : int, optional</p>
<blockquote>
<div><p>offset in bytes into <cite>infile</cite> to start reading array data. Default is 0</p>
</div></blockquote>
<p><strong>order</strong> : {&#8216;F&#8217;, &#8216;C&#8217;} string</p>
<blockquote>
<div><p>order in which to write data.  Default is &#8216;F&#8217; (fortran order).</p>
</div></blockquote>
<p><strong>mmap</strong> : {True, False, &#8216;c&#8217;, &#8216;r&#8217;, &#8216;r+&#8217;}</p>
<blockquote>
<div><p><cite>mmap</cite> controls the use of numpy memory mapping for reading data.  If
False, do not try numpy <code class="docutils literal"><span class="pre">memmap</span></code> for data array.  If one of {&#8216;c&#8217;,
&#8216;r&#8217;, &#8216;r+&#8217;}, try numpy memmap with <code class="docutils literal"><span class="pre">mode=mmap</span></code>.  A <cite>mmap</cite> value of
True gives the same behavior as <code class="docutils literal"><span class="pre">mmap='c'</span></code>.  If <cite>infile</cite> cannot be
memory-mapped, ignore <cite>mmap</cite> value and read array from file.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>arr</strong> : array-like</p>
<blockquote class="last">
<div><p>array like object that can be sliced, containing data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">BytesIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bio</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">))</span> <span class="c1"># outputs int in python3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">array_from_file</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">bio</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">arr</span> <span class="o">==</span> <span class="n">arr2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bio</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">bio</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr2</span> <span class="o">=</span> <span class="n">array_from_file</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">bio</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">arr</span> <span class="o">==</span> <span class="n">arr2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="array-to-file">
<h2>array_to_file<a class="headerlink" href="#array-to-file" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.array_to_file">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">array_to_file</code><span class="sig-paren">(</span><em>data</em>, <em>fileobj</em>, <em>out_dtype=None</em>, <em>offset=0</em>, <em>intercept=0.0</em>, <em>divslope=1.0</em>, <em>mn=None</em>, <em>mx=None</em>, <em>order='F'</em>, <em>nan2zero=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.array_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for writing arrays to file objects</p>
<p>Writes arrays as scaled by <cite>intercept</cite> and <cite>divslope</cite>, and clipped
at (prescaling) <cite>mn</cite> minimum, and <cite>mx</cite> maximum.</p>
<ul class="simple">
<li>Clip <cite>data</cite> array at min <cite>mn</cite>, max <cite>max</cite> where there are not None -&gt;
<code class="docutils literal"><span class="pre">clipped</span></code> (this is <em>pre scale clipping</em>)</li>
<li>Scale <code class="docutils literal"><span class="pre">clipped</span></code> with <code class="docutils literal"><span class="pre">clipped_scaled</span> <span class="pre">=</span> <span class="pre">(clipped</span> <span class="pre">-</span> <span class="pre">intercept)</span> <span class="pre">/</span>
<span class="pre">divslope</span></code></li>
<li>Clip <code class="docutils literal"><span class="pre">clipped_scaled</span></code> to fit into range of <cite>out_dtype</cite> (<em>post scale
clipping</em>) -&gt; <code class="docutils literal"><span class="pre">clipped_scaled_clipped</span></code></li>
<li>If converting to integer <cite>out_dtype</cite> and <cite>nan2zero</cite> is True, set NaN
values in <code class="docutils literal"><span class="pre">clipped_scaled_clipped</span></code> to 0</li>
<li>Write <code class="docutils literal"><span class="pre">clipped_scaled_clipped_n2z</span></code> to fileobj <cite>fileobj</cite> starting at
offset <cite>offset</cite> in memory layout <cite>order</cite></li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array-like</p>
<blockquote>
<div><p>array or array-like to write.</p>
</div></blockquote>
<p><strong>fileobj</strong> : file-like</p>
<blockquote>
<div><p>file-like object implementing <code class="docutils literal"><span class="pre">write</span></code> method.</p>
</div></blockquote>
<p><strong>out_dtype</strong> : None or dtype, optional</p>
<blockquote>
<div><p>dtype to write array as.  Data array will be coerced to this dtype
before writing. If None (default) then use input data type.</p>
</div></blockquote>
<p><strong>offset</strong> : None or int, optional</p>
<blockquote>
<div><p>offset into fileobj at which to start writing data. Default is 0. None
means start at current file position</p>
</div></blockquote>
<p><strong>intercept</strong> : scalar, optional</p>
<blockquote>
<div><p>scalar to subtract from data, before dividing by <code class="docutils literal"><span class="pre">divslope</span></code>.  Default
is 0.0</p>
</div></blockquote>
<p><strong>divslope</strong> : None or scalar, optional</p>
<blockquote>
<div><p>scalefactor to <em>divide</em> data by before writing.  Default is 1.0. If
None, there is no valid data, we write zeros.</p>
</div></blockquote>
<p><strong>mn</strong> : scalar, optional</p>
<blockquote>
<div><p>minimum threshold in (unscaled) data, such that all data below this
value are set to this value. Default is None (no threshold). The
typical use is to set -np.inf in the data to have this value (which
might be the minimum non-finite value in the data).</p>
</div></blockquote>
<p><strong>mx</strong> : scalar, optional</p>
<blockquote>
<div><p>maximum threshold in (unscaled) data, such that all data above this
value are set to this value. Default is None (no threshold). The
typical use is to set np.inf in the data to have this value (which
might be the maximum non-finite value in the data).</p>
</div></blockquote>
<p><strong>order</strong> : {&#8216;F&#8217;, &#8216;C&#8217;}, optional</p>
<blockquote>
<div><p>memory order to write array.  Default is &#8216;F&#8217;</p>
</div></blockquote>
<p><strong>nan2zero</strong> : {True, False}, optional</p>
<blockquote class="last">
<div><p>Whether to set NaN values to 0 when writing integer output.  Defaults
to True.  If False, NaNs will be represented as numpy does when
casting; this depends on the underlying C library and is undefined. In
practice <cite>nan2zero</cite> == False might be a good choice when you completely
sure there will be no NaNs in the data. This value ignored for float
outut types.  NaNs are treated as zero <em>before</em> applying <cite>intercept</cite>
and <cite>divslope</cite> - so an array <code class="docutils literal"><span class="pre">[np.nan]</span></code> with an <cite>intercept</cite> of 10
becomes <code class="docutils literal"><span class="pre">[-10]</span></code> after conversion to integer <cite>out_dtype</cite> with
<cite>nan2zero</cite> set.  That is because you will likely apply <cite>divslope</cite> and
<cite>intercept</cite> in reverse order when reading the data back, returning the
zero you probably expected from the input NaN.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">BytesIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_to_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sio</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># outputs 0 in python 3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_to_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sio</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">tostring</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_to_file</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">byteswap</span><span class="p">(),</span> <span class="n">sio</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">byteswap</span><span class="p">()</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sio</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array_to_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sio</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sio</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="best-write-scale-ftype">
<h2>best_write_scale_ftype<a class="headerlink" href="#best-write-scale-ftype" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.best_write_scale_ftype">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">best_write_scale_ftype</code><span class="sig-paren">(</span><em>arr</em>, <em>slope=1.0</em>, <em>inter=0.0</em>, <em>default=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.best_write_scale_ftype" title="Permalink to this definition">¶</a></dt>
<dd><p>Smallest float type to contain range of <code class="docutils literal"><span class="pre">arr</span></code> after scaling</p>
<p>Scaling that will be applied to <code class="docutils literal"><span class="pre">arr</span></code> is <code class="docutils literal"><span class="pre">(arr</span> <span class="pre">-</span> <span class="pre">inter)</span> <span class="pre">/</span> <span class="pre">slope</span></code>.</p>
<p>Note that <code class="docutils literal"><span class="pre">slope</span></code> and <code class="docutils literal"><span class="pre">inter</span></code> get promoted to 1D arrays for this
purpose to avoid the numpy scalar casting rules, which prevent scalars
upcasting the array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>arr</strong> : array-like</p>
<blockquote>
<div><p>array that will be scaled</p>
</div></blockquote>
<p><strong>slope</strong> : array-like, optional</p>
<blockquote>
<div><p>scalar such that output array will be <code class="docutils literal"><span class="pre">(arr</span> <span class="pre">-</span> <span class="pre">inter)</span> <span class="pre">/</span> <span class="pre">slope</span></code>.</p>
</div></blockquote>
<p><strong>inter</strong> : array-like, optional</p>
<blockquote>
<div><p>scalar such that output array will be <code class="docutils literal"><span class="pre">(arr</span> <span class="pre">-</span> <span class="pre">inter)</span> <span class="pre">/</span> <span class="pre">slope</span></code></p>
</div></blockquote>
<p><strong>default</strong> : numpy type, optional</p>
<blockquote>
<div><p>minimum float type to return</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ftype</strong> : numpy type</p>
<blockquote class="last">
<div><p>Best floating point type for scaling.  If no floating point type
prevents overflow, return the top floating point type.  If the input
array <code class="docutils literal"><span class="pre">arr</span></code> already contains inf values, return the greater of the
input type and the default type.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_write_scale_ftype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Specify higher default return value</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">best_write_scale_ftype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Even large values that don&#8217;t overflow don&#8217;t change output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">best_write_scale_ftype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Scaling &gt; 1 reduces output values, so no upcast needed</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">best_write_scale_ftype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Scaling &lt; 1 increases values, so upcast may be needed (and is here)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">best_write_scale_ftype</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">0.5</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="better-float-of">
<h2>better_float_of<a class="headerlink" href="#better-float-of" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.better_float_of">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">better_float_of</code><span class="sig-paren">(</span><em>first</em>, <em>second</em>, <em>default=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.better_float_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Return more capable float type of <cite>first</cite> and <cite>second</cite></p>
<p>Return <cite>default</cite> if neither of <cite>first</cite> or <cite>second</cite> is a float</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>first</strong> : numpy type specifier</p>
<blockquote>
<div><p>Any valid input to <cite>np.dtype()`</cite></p>
</div></blockquote>
<p><strong>second</strong> : numpy type specifier</p>
<blockquote>
<div><p>Any valid input to <cite>np.dtype()`</cite></p>
</div></blockquote>
<p><strong>default</strong> : numpy type specifier, optional</p>
<blockquote>
<div><p>Any valid input to <cite>np.dtype()`</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>better_type</strong> : numpy type</p>
<blockquote class="last">
<div><p>More capable of <cite>first</cite> or <cite>second</cite> if both are floats; if only one is
a float return that, otherwise return <cite>default</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">better_float_of</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">better_float_of</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">better_float_of</span><span class="p">(</span><span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;u4&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">better_float_of</span><span class="p">(</span><span class="s1">&#39;i2&#39;</span><span class="p">,</span> <span class="s1">&#39;u4&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="calculate-scale">
<h2>calculate_scale<a class="headerlink" href="#calculate-scale" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.calculate_scale">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">calculate_scale</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.calculate_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate scaling and optional intercept for data</p>
<p>calculate_scale deprecated. Please use arraywriter classes instead</p>
<ul class="simple">
<li>deprecated from version: 1.2</li>
<li>Will raise &lt;class &#8216;nibabel.deprecator.ExpiredDeprecationError&#8217;&gt; as of version: 3.0</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array</p>
<p><strong>out_dtype</strong> : dtype</p>
<blockquote>
<div><p>output data type in some form understood by <code class="docutils literal"><span class="pre">np.dtype</span></code></p>
</div></blockquote>
<p><strong>allow_intercept</strong> : bool</p>
<blockquote>
<div><p>If True allow non-zero intercept</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>scaling</strong> : None or float</p>
<blockquote>
<div><p>scalefactor to divide into data.  None if no valid data</p>
</div></blockquote>
<p><strong>intercept</strong> : None or float</p>
<blockquote>
<div><p>intercept to subtract from data.  None if no valid data</p>
</div></blockquote>
<p><strong>mn</strong> : None or float</p>
<blockquote>
<div><p>minimum of finite value in data or None if this will not
be used to threshold data</p>
</div></blockquote>
<p><strong>mx</strong> : None or float</p>
<blockquote class="last">
<div><p>minimum of finite value in data, or None if this will not
be used to threshold data</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="can-cast">
<h2>can_cast<a class="headerlink" href="#can-cast" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.can_cast">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">can_cast</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.can_cast" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if we can safely cast <code class="docutils literal"><span class="pre">in_type</span></code> to <code class="docutils literal"><span class="pre">out_type</span></code></p>
<p>can_cast deprecated. Please use arraywriter classes instead</p>
<ul class="simple">
<li>deprecated from version: 1.2</li>
<li>Will raise &lt;class &#8216;nibabel.deprecator.ExpiredDeprecationError&#8217;&gt; as of version: 3.0</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>in_type</strong> : numpy type</p>
<blockquote>
<div><p>type of data we will case from</p>
</div></blockquote>
<p><strong>out_dtype</strong> : numpy type</p>
<blockquote>
<div><p>type that we want to cast to</p>
</div></blockquote>
<p><strong>has_intercept</strong> : bool, optional</p>
<blockquote>
<div><p>Whether we can subtract a constant from the data (before scaling)
before casting to <code class="docutils literal"><span class="pre">out_dtype</span></code>.  Default is False</p>
</div></blockquote>
<p><strong>has_slope</strong> : bool, optional</p>
<blockquote>
<div><p>Whether we can use a scaling factor to adjust slope of
relationship of data to data in cast array.  Default is False</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>tf</strong> : bool</p>
<blockquote class="last">
<div><p>True if we can safely cast, False otherwise</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Whether we can actually cast int to uint when we don&#8217;t have an intercept
depends on the data.  That&#8217;s why this function isn&#8217;t very useful. But we
assume that an integer is using its full range, and check whether scaling
works in that situation.</p>
<p>Here we need an intercept to scale the full range of an int to a uint</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">can_cast</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="finite-range">
<h2>finite_range<a class="headerlink" href="#finite-range" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.finite_range">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">finite_range</code><span class="sig-paren">(</span><em>arr</em>, <em>check_nan=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.finite_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Get range (min, max) or range and flag (min, max, has_nan) from <cite>arr</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>arr</strong> : array-like</p>
<p><strong>check_nan</strong> : {False, True}, optional</p>
<blockquote>
<div><p>Whether to return third output, a bool signaling whether there are NaN
values in <cite>arr</cite></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mn</strong> : scalar</p>
<blockquote>
<div><p>minimum of values in (flattened) array</p>
</div></blockquote>
<p><strong>mx</strong> : scalar</p>
<blockquote>
<div><p>maximum of values in (flattened) array</p>
</div></blockquote>
<p><strong>has_nan</strong> : bool</p>
<blockquote class="last">
<div><p>Returned if <cite>check_nan</cite> is True. <cite>has_nan</cite> is True if there are one or
more NaN values in <cite>arr</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(-1.0, 1.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">check_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(-1.0, 1.0, True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">],[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(-3, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(0, 4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(1j, (4+1j))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span> <span class="s1">&#39;i2&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">finite_range</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
   <span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Can only handle numeric types</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="fname-ext-ul-case">
<h2>fname_ext_ul_case<a class="headerlink" href="#fname-ext-ul-case" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.fname_ext_ul_case">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">fname_ext_ul_case</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.fname_ext_ul_case" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>fname</cite> with ext changed to upper / lower case if file exists</p>
<p>Check for existence of <cite>fname</cite>.  If it does exist, return unmodified.  If
it doesn&#8217;t, check for existence of <cite>fname</cite> with case changed from lower to
upper, or upper to lower.  Return this modified <cite>fname</cite> if it exists.
Otherwise return <cite>fname</cite> unmodified</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fname</strong> : str</p>
<blockquote>
<div><p>filename.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>mod_fname</strong> : str</p>
<blockquote class="last">
<div><p>filename, maybe with extension of opposite case</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="int-scinter-ftype">
<h2>int_scinter_ftype<a class="headerlink" href="#int-scinter-ftype" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.int_scinter_ftype">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">int_scinter_ftype</code><span class="sig-paren">(</span><em>ifmt</em>, <em>slope=1.0</em>, <em>inter=0.0</em>, <em>default=&lt;type 'numpy.float32'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.int_scinter_ftype" title="Permalink to this definition">¶</a></dt>
<dd><p>float type containing int type <cite>ifmt</cite> * <cite>slope</cite> + <cite>inter</cite></p>
<p>Return float type that can represent the max and the min of the <cite>ifmt</cite> type
after multiplication with <cite>slope</cite> and addition of <cite>inter</cite> with something
like <code class="docutils literal"><span class="pre">np.array([imin,</span> <span class="pre">imax],</span> <span class="pre">dtype=ifmt)</span> <span class="pre">*</span> <span class="pre">slope</span> <span class="pre">+</span> <span class="pre">inter</span></code>.</p>
<p>Note that <code class="docutils literal"><span class="pre">slope</span></code> and <code class="docutils literal"><span class="pre">inter</span></code> get promoted to 1D arrays for this
purpose to avoid the numpy scalar casting rules, which prevent scalars
upcasting the array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ifmt</strong> : object</p>
<blockquote>
<div><p>numpy integer type (e.g. np.int32)</p>
</div></blockquote>
<p><strong>slope</strong> : float, optional</p>
<blockquote>
<div><p>slope, default 1.0</p>
</div></blockquote>
<p><strong>inter</strong> : float, optional</p>
<blockquote>
<div><p>intercept, default 0.0</p>
</div></blockquote>
<p><strong>default_out</strong> : object, optional</p>
<blockquote>
<div><p>numpy floating point type, default is <code class="docutils literal"><span class="pre">np.float32</span></code></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>ftype</strong> : object</p>
<blockquote class="last">
<div><p>numpy floating point type</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>It is difficult to make floats overflow with just addition because the
deltas are so large at the extremes of floating point.  For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">arr</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">==</span> <span class="n">res</span>
<span class="go">array([ True], dtype=bool)</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">int_scinter_ftype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_scinter_ftype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="mi">1</span><span class="n">e38</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="make-dt-codes">
<h2>make_dt_codes<a class="headerlink" href="#make-dt-codes" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.make_dt_codes">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">make_dt_codes</code><span class="sig-paren">(</span><em>codes_seqs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.make_dt_codes" title="Permalink to this definition">¶</a></dt>
<dd><p>Create full dt codes Recoder instance from datatype codes</p>
<p>Include created numpy dtype (from numpy type) and opposite endian
numpy dtype</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>codes_seqs</strong> : sequence of sequences</p>
<blockquote>
<div><p>contained sequences make be length 3 or 4, but must all be the same
length. Elements are data type code, data type name, and numpy
type (such as <code class="docutils literal"><span class="pre">np.float32</span></code>).  The fourth element is the nifti string
representation of the code (e.g. &#8220;NIFTI_TYPE_FLOAT32&#8221;)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>rec</strong> : <code class="docutils literal"><span class="pre">Recoder</span></code> instance</p>
<blockquote class="last">
<div><p>Recoder that, by default, returns <code class="docutils literal"><span class="pre">code</span></code> when indexed with any
of the corresponding code, name, type, dtype, or swapped dtype.
You can also index with <code class="docutils literal"><span class="pre">niistring</span></code> values if codes_seqs had sequences
of length 4 instead of 3.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="pretty-mapping">
<h2>pretty_mapping<a class="headerlink" href="#pretty-mapping" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.pretty_mapping">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">pretty_mapping</code><span class="sig-paren">(</span><em>mapping</em>, <em>getterfunc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.pretty_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Make pretty string from mapping</p>
<p>Adjusts text column to print values on basis of longest key.
Probably only sensible if keys are mainly strings.</p>
<p>You can pass in a callable that does clever things to get the values
out of the mapping, given the names.  By default, we just use
<code class="docutils literal"><span class="pre">__getitem__</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mapping</strong> : mapping</p>
<blockquote>
<div><p>implementing iterator returning keys and .items()</p>
</div></blockquote>
<p><strong>getterfunc</strong> : None or callable</p>
<blockquote>
<div><p>callable taking two arguments, <code class="docutils literal"><span class="pre">obj</span></code> and <code class="docutils literal"><span class="pre">key</span></code> where <code class="docutils literal"><span class="pre">obj</span></code>
is the passed mapping.  If None, just use <code class="docutils literal"><span class="pre">lambda</span> <span class="pre">obj,</span> <span class="pre">key:</span>
<span class="pre">obj[key]</span></code></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>str</strong> : string</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a key&#39;</span><span class="p">:</span> <span class="s1">&#39;a value&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pretty_mapping</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="go">a key  : a value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span> <span class="c1"># to control ordering, show get_ method</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="nb">iter</span><span class="p">((</span><span class="s1">&#39;short_field&#39;</span><span class="p">,</span><span class="s1">&#39;longer_field&#39;</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;short_field&#39;</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="mi">0</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;longer_field&#39;</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s1">&#39;str&#39;</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">get_longer_field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s1">&#39;method string&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">getter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c1"># Look for any &#39;get_&lt;name&gt;&#39; methods</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="s1">&#39;get_&#39;</span> <span class="o">+</span> <span class="n">key</span><span class="p">)()</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pretty_mapping</span><span class="p">(</span><span class="n">C</span><span class="p">(),</span> <span class="n">getter</span><span class="p">))</span>
<span class="go">short_field   : 0</span>
<span class="go">longer_field  : method string</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="rec2dict">
<h2>rec2dict<a class="headerlink" href="#rec2dict" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.rec2dict">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">rec2dict</code><span class="sig-paren">(</span><em>rec</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.rec2dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert recarray to dictionary</p>
<p>Also converts scalar values to scalars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rec</strong> : ndarray</p>
<blockquote>
<div><p>structured ndarray</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dct</strong> : dict</p>
<blockquote class="last">
<div><p>dict with key, value pairs as for <cite>rec</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((),</span> <span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;i4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;S10&#39;</span><span class="p">)])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">rec2dict</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span> <span class="n">b</span><span class="s1">&#39;&#39;</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="scale-min-max">
<h2>scale_min_max<a class="headerlink" href="#scale-min-max" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.scale_min_max">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">scale_min_max</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.scale_min_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return scaling and intercept min, max of data, given output type</p>
<p>scale_min_max deprecated. Please use arraywriter classes instead.</p>
<ul class="simple">
<li>deprecated from version: 1.2</li>
<li>Will raise &lt;class &#8216;nibabel.deprecator.ExpiredDeprecationError&#8217;&gt; as of version: 3.0</li>
</ul>
<p>Returns <code class="docutils literal"><span class="pre">scalefactor</span></code> and <code class="docutils literal"><span class="pre">intercept</span></code> to best fit data with
given <code class="docutils literal"><span class="pre">mn</span></code> and <code class="docutils literal"><span class="pre">mx</span></code> min and max values into range of data type
with <code class="docutils literal"><span class="pre">type_min</span></code> and <code class="docutils literal"><span class="pre">type_max</span></code> min and max values for type.</p>
<p>The calculated scaling is therefore:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">scaled_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">-</span><span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scalefactor</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mn</strong> : scalar</p>
<blockquote>
<div><p>data minimum value</p>
</div></blockquote>
<p><strong>mx</strong> : scalar</p>
<blockquote>
<div><p>data maximum value</p>
</div></blockquote>
<p><strong>out_type</strong> : numpy type</p>
<blockquote>
<div><p>numpy type of output</p>
</div></blockquote>
<p><strong>allow_intercept</strong> : bool</p>
<blockquote>
<div><p>If true, allow calculation of non-zero intercept.  Otherwise,
returned intercept is always 0.0</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>scalefactor</strong> : numpy scalar, dtype=np.maximum_sctype(np.float)</p>
<blockquote>
<div><p>scalefactor by which to divide data after subtracting intercept</p>
</div></blockquote>
<p><strong>intercept</strong> : numpy scalar, dtype=np.maximum_sctype(np.float)</p>
<blockquote class="last">
<div><p>value to subtract from data before dividing by scalefactor</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>We don&#8217;t use this function anywhere in nibabel now, it&#8217;s here for API
compatibility only.</p>
<p>The large integers lead to python long types as max / min for type.
To contain the rounding error, we need to use the maximum numpy
float types when casting to float.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">scale_min_max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">(1.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_min_max</span><span class="p">(</span><span class="o">-</span><span class="mi">128</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">(1.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scale_min_max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">(1.0, 0.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaling</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">scale_min_max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span>  <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">0</span> <span class="o">-</span> <span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaling</span><span class="p">,</span> <span class="o">-</span><span class="mi">128</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">127</span> <span class="o">-</span> <span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaling</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaling</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">scale_min_max</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="o">-</span><span class="mi">10</span> <span class="o">-</span> <span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaling</span><span class="p">,</span> <span class="o">-</span><span class="mi">128</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaling</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaling</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">=</span> <span class="n">scale_min_max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaling</span><span class="p">,</span> <span class="o">-</span><span class="mi">128</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">((</span><span class="mi">10</span> <span class="o">-</span> <span class="n">intercept</span><span class="p">)</span> <span class="o">/</span> <span class="n">scaling</span><span class="p">,</span> <span class="mi">127</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="seek-tell">
<h2>seek_tell<a class="headerlink" href="#seek-tell" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.seek_tell">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">seek_tell</code><span class="sig-paren">(</span><em>fileobj</em>, <em>offset</em>, <em>write0=False</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.seek_tell" title="Permalink to this definition">¶</a></dt>
<dd><p>Seek in <cite>fileobj</cite> or check we&#8217;re in the right place already</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file-like</p>
<blockquote>
<div><p>object implementing <code class="docutils literal"><span class="pre">seek</span></code> and (if seek raises an IOError) <code class="docutils literal"><span class="pre">tell</span></code></p>
</div></blockquote>
<p><strong>offset</strong> : int</p>
<blockquote>
<div><p>position in file to which to seek</p>
</div></blockquote>
<p><strong>write0</strong> : {False, True}, optional</p>
<blockquote class="last">
<div><p>If True, and standard seek fails, try to write zeros to the file to
reach <cite>offset</cite>.  This can be useful when writing bz2 files, that cannot
do write seeks.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="shape-zoom-affine">
<h2>shape_zoom_affine<a class="headerlink" href="#shape-zoom-affine" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.shape_zoom_affine">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">shape_zoom_affine</code><span class="sig-paren">(</span><em>shape</em>, <em>zooms</em>, <em>x_flip=True</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.shape_zoom_affine" title="Permalink to this definition">¶</a></dt>
<dd><p>Get affine implied by given shape and zooms</p>
<p>We get the translations from the center of the image (implied by
<cite>shape</cite>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>shape</strong> : (N,) array-like</p>
<blockquote>
<div><p>shape of image data. <code class="docutils literal"><span class="pre">N</span></code> is the number of dimensions</p>
</div></blockquote>
<p><strong>zooms</strong> : (N,) array-like</p>
<blockquote>
<div><p>zooms (voxel sizes) of the image</p>
</div></blockquote>
<p><strong>x_flip</strong> : {True, False}</p>
<blockquote>
<div><p>whether to flip the X row of the affine.  Corresponds to
radiological storage on disk.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>aff</strong> : (4,4) array</p>
<blockquote class="last">
<div><p>affine giving correspondance of voxel coordinates to mm
coordinates, taking the center of the image as origin</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zooms</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_zoom_affine</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">array([[-3.,  0.,  0.,  3.],</span>
<span class="go">       [ 0.,  2.,  0., -4.],</span>
<span class="go">       [ 0.,  0.,  1., -3.],</span>
<span class="go">       [ 0.,  0.,  0.,  1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape_zoom_affine</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">array([[ 3.,  0.,  0., -3.],</span>
<span class="go">       [ 0.,  2.,  0., -4.],</span>
<span class="go">       [ 0.,  0.,  1., -3.],</span>
<span class="go">       [ 0.,  0.,  0.,  1.]])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="working-type">
<h2>working_type<a class="headerlink" href="#working-type" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.working_type">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">working_type</code><span class="sig-paren">(</span><em>in_type</em>, <em>slope=1.0</em>, <em>inter=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.working_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return array type from applying <cite>slope</cite>, <cite>inter</cite> to array of <cite>in_type</cite></p>
<p>Numpy type that results from an array of type <cite>in_type</cite> being combined with
<cite>slope</cite> and <cite>inter</cite>. It returns something like the dtype type of
<code class="docutils literal"><span class="pre">((np.zeros((2,),</span> <span class="pre">dtype=in_type)</span> <span class="pre">-</span> <span class="pre">inter)</span> <span class="pre">/</span> <span class="pre">slope)</span></code>, but ignoring the
actual values of <cite>slope</cite> and <cite>inter</cite>.</p>
<p>Note that you would not necessarily get the same type by applying slope and
inter the other way round.  Also, you&#8217;ll see that the order in which slope
and inter are applied is the opposite of the order in which they are
passed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>in_type</strong> : numpy type specifier</p>
<blockquote>
<div><p>Numpy type of input array.  Any valid input for <code class="docutils literal"><span class="pre">np.dtype()</span></code></p>
</div></blockquote>
<p><strong>slope</strong> : scalar, optional</p>
<blockquote>
<div><p>slope to apply to array.  If 1.0 (default), ignore this value and its
type.</p>
</div></blockquote>
<p><strong>inter</strong> : scalar, optional</p>
<blockquote>
<div><p>intercept to apply to array.  If 0.0 (default), ignore this value and
its type.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">wtype: numpy type</p>
<blockquote class="last">
<div><p>Numpy type resulting from applying <cite>inter</cite> and <cite>slope</cite> to array of type
<cite>in_type</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="write-zeros">
<h2>write_zeros<a class="headerlink" href="#write-zeros" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="nibabel.volumeutils.write_zeros">
<code class="descclassname">nibabel.volumeutils.</code><code class="descname">write_zeros</code><span class="sig-paren">(</span><em>fileobj</em>, <em>count</em>, <em>block_size=8194</em><span class="sig-paren">)</span><a class="headerlink" href="#nibabel.volumeutils.write_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <cite>count</cite> zero bytes to <cite>fileobj</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>fileobj</strong> : file-like object</p>
<blockquote>
<div><p>with <code class="docutils literal"><span class="pre">write</span></code> method</p>
</div></blockquote>
<p><strong>count</strong> : int</p>
<blockquote>
<div><p>number of bytes to write</p>
</div></blockquote>
<p><strong>block_size</strong> : int, optional</p>
<blockquote class="last">
<div><p>largest continuous block to write.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2006-2016, Matthew Brett, Michael Hanke, Eric Larson, Chris Markiewicz &lt;neuroimaging@python.org&gt;.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.6.
    </div>
  </body>
</html>